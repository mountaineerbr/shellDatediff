<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jamil Soni N" />
  <title>DATEDIFF.SH(1) v0.24.3 | General Commands Manual</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">DATEDIFF.SH(1) v0.24.3 | General Commands Manual</h1>
<p class="author">Jamil Soni N</p>
<p class="date">October 2024</p>
</header>
<h1 id="name">NAME</h1>
<div class="line-block">   <strong>datediff.sh</strong> - Calculate time
ranges / intervals between dates</div>
<h2 id="synopsis">SYNOPSIS</h2>
<div class="line-block">   <strong>datediff.sh</strong>
[<strong>-Rrttuvvv</strong>] [<code>-</code><em>NUM</em>]
[<code>-f</code><em>"FMT"</em>] <em>DATE1</em> <em>DATE2</em>
[<em>UNIT</em>]<br />
   <strong>datediff.sh</strong> <strong>-FF</strong>
[<strong>-vv</strong>] [[<em>DAY_IN_WEEK</em>] [<em>DAY_IN_MONTH</em>]]
[<em>START_DATE</em>]<br />
   <strong>datediff.sh</strong> <strong>-eel</strong>
[<strong>-v</strong>] <em>YEAR</em>..<br />
   <strong>datediff.sh</strong> <strong>-m</strong>
[<strong>-v</strong>] <em>DATE</em>..<br />
   <strong>datediff.sh</strong> <strong>-h</strong></div>
<h2 id="description">DESCRIPTION</h2>
<p>Calculate <strong>time interval</strong> (elapsed) between
<em>DATE1</em> and <em>DATE2</em> in various time units. The
<code>C-code date</code> programme is optionally run to process
dates.</p>
<p>Extra functions include checking if <em>YEAR</em> is
<strong>leap</strong>, generating <strong>Easter</strong>,
<strong>Carnaval</strong>, and <strong>Corpus Christi</strong>
<strong>dates</strong> on a given <em>YEAR</em> and the <strong>phase of
the moon</strong> at <em>DATE</em>.</p>
<h3 id="main-function">Main Function</h3>
<p>In the main function, <code>GNU date</code> accepts mostly free
format human readable date strings. If using <code>FreeBSD date</code>,
input <em>DATE</em> strings must be <strong>ISO-8601</strong>
(<em>YYYY-MM-DDThh:mm:ss</em>), unless <strong>option -f</strong>
<em>FMT</em> is set to a new input time format. If
<code>C-code date</code> programme is not available then input must be
formatted as <strong>ISO-8601</strong> or <strong>UNIX
time</strong>.</p>
<p>If <em>DATE</em> is not set, defaults to <em>now</em>. If only one
<em>DATE</em> is set, the first one is assumed to be <em>now</em> or
<em>1970</em>.</p>
<p>To flag <em>DATE</em> as <strong>UNIX time</strong>, prepend an “at”
sign “<em>@</em>” to it or set <strong>option -r</strong>.</p>
<p>Stdin input supports one <em>DATE</em> string per line (max two
lines) or two ISO-8601 <em>DATES</em> separated by space in a single
line. Input is processed in a best effort basis.</p>
<h3 id="main-output">Main Output</h3>
<p>Output <strong>“RANGES”</strong> section displays intervals in
<strong>different units of time</strong> (years, or months, or weeks, or
days, or hours, or minutes, or seconds alone). It also displays a
<strong>compound time range</strong> with all the above units into
consideration to each other.</p>
<p>Single <em>UNIT</em> time periods can be displayed in <strong>table
format</strong> with <strong>option -t</strong> and their
<strong>scale</strong> set with command line <strong>option
-NUM</strong> where <em>NUM</em> is an integer. The least significant
digit of the result is subject to rounding. When last positional
parameter <em>UNIT</em> is exactly one of <em>Y</em>, <em>MO</em>,
<em>W</em>, <em>D</em>, <em>H</em>, <em>M</em>, or <em>S</em>, only a
single <em>UNIT</em> interval is printed to stdout.</p>
<p>Output <strong>“DATES”</strong> section prints two dates in
<strong>ISO-8601 format</strong> or, if <strong>option -R</strong> is
set, <strong>RFC-5322 format</strong>.</p>
<p><strong>Option -u</strong> sets or prints dates in
<strong>Coordinated Universal Time (UTC)</strong> in the main function.
This affects how the <code>C-code date</code> programme process
dates.</p>
<h3 id="extra-functions">Extra Functions</h3>
<p><strong>Option -e</strong> prints <strong>Easter dates</strong> for
given <em>YEARS</em> (for Western Churches) and <strong>option
-ee</strong> additionally prints <strong>Carnaval</strong> and
<strong>Corpus Christi dates</strong>.</p>
<p><strong>Option -l</strong> checks if a <em>YEAR</em> <strong>is
leap</strong>. Set <strong>option -v</strong> to <strong>decrease
verbosity</strong>. The ISO-8601 system assumes proleptic Gregorian
calendar, year zero and no leap seconds.</p>
<p><strong>Option -m</strong> prints <strong>lunar phase</strong> at
<em>DATE</em> as <em>YYYY[-MM[-DD]]</em>, auto expansion takes place on
partial <em>DATE input</em>. <em>DATE</em> ought to be <strong>UTC
time</strong>. Code snippet adapted from <em>NetHack</em>.</p>
<p>Option <code>-F</code> prints the date of next <strong>Friday the
13th</strong>. The <em>START_DATE</em> must be formated as
<em>YYY[-MM[-DD]]</em>. Optionally, set <em>day in the week</em>, such
as <em>Sunday</em>, and <em>day number in month</em> as first and second
positional parameters. Set option <code>-FF</code> to print the
following ten matches.</p>
<h3 id="timezone-offsets">Timezone Offsets</h3>
<p><strong>DATE offsets</strong> as per ISO-8601 are supported
throughout this script. When environment <em>$TZ</em> is a positive or
negative decimal number, such as <em>UTC+3</em>, it is read as offset.
Variable <em>$TZ</em> with timezone name or ID
(e.g. <strong>America/Sao_Paulo</strong>) is supported by <strong>C-code
date</strong> warping only.</p>
<p>This script uses <code>Bash</code> / <code>Ksh</code> arithmetics to
perform most time range calculations.</p>
<h3 id="debug-and-direct-execution">Debug and Direct Execution</h3>
<p><strong>Option -d</strong> sets <em>TZ=UTC</em>, unsets verbose
switches and run checks against <code>C-code datediff</code> and
<code>C-code date</code>. Set once to dump only when results differ and
set twice to code exit only.</p>
<p><strong>Option -D</strong> disables C-code date warping and
<strong>option -DD</strong> disables <code>Bash</code>/<code>Ksh</code>
<code>printf %()T</code> warping, too.</p>
<p>The project source is hosted at:</p>
<pre><code>&lt;https://gitlab.com/fenixdragao/shelldatediff&gt;
&lt;https://github.com/mountaineerbr/shellDatediff&gt;</code></pre>
<h2 id="refinement-rules">REFINEMENT RULES</h2>
<p>Some time intervals can be calculated in more than one way depending
on the logic used in the <code>compound time range</code> display. We
decided to mimic <em>Hroptatyr</em>’s <code>datediff</code> refinement
rules as often as possible.</p>
<p>Script error rate of the core code is estimated to be lower than one
percent after extensive testing with selected and corner-case sample
dates and times. Check the script source code and repository for
details.</p>
<h2 id="environment">ENVIRONMENT</h2>
<dl>
<dt><strong>CFACTOR</strong></dt>
<dd>
<p>Correction factor used in the lunar phase function.</p>
<p>Defaults="<em>-1892</em>"</p>
</dd>
<dt><strong>DATE_CMD</strong></dt>
<dd>
<p>Path to <code>C-code date</code> programme. <strong>GNU</strong>,
<strong>BSD</strong>, <strong>AST</strong>, and <strong>Busybox</strong>
<strong>date</strong> are supported.</p>
</dd>
<dt><strong>TZ</strong></dt>
<dd>
<p>Offset time. POSIX time zone definition by the $TZ variable takes a
different form from ISO-8601 standards, so that ISO UTC-03 is equivalent
to setting $TZ=UTC+03.</p>
<p>Only the <strong>C-code date</strong> programme can parse timezone
names and IDS.</p>
</dd>
</dl>
<h2 id="warranty">WARRANTY</h2>
<p>Licensed under the <strong>GNU General Public License 3</strong> or
better. This software is distributed without support or bug corrections.
Many thanks for all whose advice improved this script from
<strong>c.u.shell</strong>.</p>
<p><code>Bash2.05b+</code>, <code>Ksh93</code> or <code>Zsh</code> is
required. <code>Bc</code> or <code>Ksh93</code> is required for
single-unit calculations. <strong>FreeBSD12+</strong> or
<strong>GNU</strong> <strong>date</strong> is optionally required.</p>
<h2 id="see-also">SEE ALSO</h2>
<ul>
<li><code>Datediff</code> from <code>dateutils</code>, by
<em>Hroptatyr</em> &lt;www.fresse.org/dateutils/&gt;</li>
<li><code>PDD</code> from <em>Jarun</em>
&lt;github.com/jarun/pdd&gt;</li>
<li><code>AST date</code> elapsed time <code>option -E</code>
&lt;github.com/att/ast&gt;</li>
<li><code>Units</code> from GNU. <a
href="https://www.gnu.org/software/units/"
class="uri">https://www.gnu.org/software/units/</a></li>
<li>Do calendrical savants use calculation to answer date questions? A
functional magnetic resonance imaging study, <em>Cowan and Frith</em>,
2009. <a
href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2677581/#!po=21.1864"
class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2677581/#!po=21.1864</a></li>
<li>Calendrical calculation, <em>Dershowitz and Reingold</em>, 1990 <a
href="http://www.cs.tau.ac.il/~nachum/papers/c/home/jsn/www/lab-shelldatediff/man/datediff.sh.1.mdc-paper.pdf"
class="uri">http://www.cs.tau.ac.il/~nachum/papers/c/home/jsn/www/lab-shelldatediff/man/datediff.sh.1.mdc-paper.pdf</a>
<a href="https://books.google.com.br/books?id=DPbx0-qgXu0C"
class="uri">https://books.google.com.br/books?id=DPbx0-qgXu0C</a></li>
<li>How many days are in a year? <em>Manning</em>, 1997. <a
href="https://pumas.nasa.gov/files/04_21_97_1.pdf"
class="uri">https://pumas.nasa.gov/files/04_21_97_1.pdf</a></li>
<li>Iana Time zone database <a href="https://www.iana.org/time-zones"
class="uri">https://www.iana.org/time-zones</a></li>
<li>Fun with Date Arithmetic (see replies) <a
href="https://linuxcommando.blogspot.com/2009/11/fun-with-date-arithmetic.html"
class="uri">https://linuxcommando.blogspot.com/2009/11/fun-with-date-arithmetic.html</a></li>
</ul>
<div class="line-block">Tip: Division is but subtractions and
multiplication but additions.<br />
–Lost reference</div>
<h2 id="examples">EXAMPLES</h2>
<p><strong>Leap year check</strong></p>
<div class="line-block">   datediff.sh <strong>-l</strong> 2000<br />
   datediff.sh <strong>-l</strong> {1980..2000}<br />
   echo 2000 | datediff.sh <strong>-l</strong></div>
<p><strong>Moon phases for January 1996</strong></p>
<div class="line-block">   datediff.sh <strong>-m</strong> 1996-01</div>
<p><strong>Print following Friday, 13th</strong></p>
<div class="line-block">   datediff.sh <strong>-F</strong></div>
<p><strong>Print following Sunday, 12th after 1999</strong></p>
<div class="line-block">   datediff.sh <strong>-F</strong> sun 12
1999</div>
<p><strong>Single unit time periods</strong></p>
<div class="line-block">   datediff.sh 2022-03-01T00:00:00
2022-03-01T10:10:10 <em>m</em><br />
   datediff.sh '10 years ago' <em>mo</em><br />
   datediff.sh 1970-01-01 2000-02-02 <em>y</em></div>
<p><strong>Time ranges/intervals</strong></p>
<div class="line-block">   datediff.sh 2020-01-03T14:30:10
2020-12-24T00:00:00<br />
   datediff.sh 0921-04-12 1999-01-31<br />
   echo 1970-01-01 2000-02-02 | datediff.sh<br />
   <em>TZ=UTC+3</em> datediff.sh 2020-01-03T14:30:10-06
2021-12-30T21:00:10-03:20</div>
<p><strong>GNU date warping</strong></p>
<div class="line-block">   datediff.sh 'next monday'<br />
   datediff.sh 2019/6/28 1Aug<br />
   datediff.sh '5min 34seconds'<br />
   datediff.sh 1aug1990-9month now<br />
   datediff.sh -- -2week-3day<br />
   datediff.sh -- "today + 1day" <em>@</em>1952292365<br />
   datediff.sh <strong>-2</strong> -- '1hour ago 30min ago'<br />
   datediff.sh today00:00 '12 May 2020 14:50:50'<br />
   datediff.sh '2020-01-01 - 6months' 2020-01-01<br />
   datediff.sh '05 jan 2005’ 'now - 43years -13 days'<br />
   datediff.sh <strong>-u</strong> 2023-01-14T11:20:00Z
'2023-01-14T11:20:00Z + 5 hours'<br />
   datediff.sh <em>@</em>1561243015 <em>@</em>1592865415</div>
<p><strong>BSD date warping</strong></p>
<div class="line-block">   datediff.sh <strong>-f</strong>'%m/%d/%Y'
6/28/2019 9/04/1970<br />
   datediff.sh <strong>-r</strong> 1561243015 1592865415<br />
   datediff.sh 200002280910.33 0003290010.00<br />
   datediff.sh -- '-v +2d' '-v -3w'</div>
<h2 id="options">OPTIONS</h2>
<p><strong>Extra Functions</strong></p>
<dl>
<dt><strong>-e</strong> [<em>YEAR</em>..]</dt>
<dd>
<p>Print Western Easter dates.</p>
</dd>
<dt><strong>-ee</strong> [<em>YEAR</em>..]</dt>
<dd>
<p>Print Carnaval, Easter and Corpus Christi dates.</p>
</dd>
<dt><strong>-FF</strong> [[<em>DAY_IN_WEEK</em>]
[<em>DAY_IN_MONTH</em>]] [<em>START_DATE</em>]</dt>
<dd>
<p>Print following Friday the 13th date.</p>
</dd>
<dt><strong>-h</strong></dt>
<dd>
<p>Print this help page.</p>
</dd>
<dt><strong>-l</strong> [<em>YEAR</em>..]</dt>
<dd>
<p>Check if YEAR is leap year.</p>
</dd>
<dt><strong>-m</strong> [<em>YYYY[-MM[-DD]]</em>]</dt>
<dd>
<p>Print lunar phase at DATE (ISO UTC time).</p>
</dd>
</dl>
<p><strong>Main Function</strong></p>
<dl>
<dt><strong>-[<strong><em>0-9</em></strong>]</strong></dt>
<dd>
<p>Set scale for single unit interval results.</p>
</dd>
<dt><strong>-DD</strong>, <strong>-dd</strong></dt>
<dd>
<p>Debug options, check help page.</p>
</dd>
<dt><strong>-f</strong> [<em>FMT</em>]</dt>
<dd>
<p>Input time string format (only with <code>BSD date</code>).</p>
</dd>
<dt><strong>-R</strong></dt>
<dd>
<p>Print human time in RFC-5322 format (verbose).</p>
</dd>
<dt><strong>-r</strong>, <strong>-@</strong></dt>
<dd>
<p>Input DATES are UNIX times.</p>
</dd>
<dt><strong>-t</strong>, <strong>-tt</strong></dt>
<dd>
<p>Table layouts display of single unit intervals (such as
<code>-vtt</code>).</p>
</dd>
<dt><strong>-u</strong></dt>
<dd>
<p>Set or print in UTC times instead of local times. This affects how
<code>C-code date</code> process input dates.</p>
</dd>
<dt><strong>-v</strong>, <strong>-vv</strong>,
<strong>-vvv</strong></dt>
<dd>
<p>Change how output is displayed, verbose levels.</p>
</dd>
</dl>
<!-- Verbose level, change print layout of functions. -->
<!-- Generate the man page:
    pandoc --standalone --to man ~/bin/ddate/datediff.sh.1.md -o ./datediff.sh.1
-->
</body>
</html>
